Declare @fy_start As Date = '2020-10-31'
-- Set @fy_start = (
--     Select 
-- 		Case
-- 			When 
-- 				Month(GetDate()) > 11 Then DateFromParts(Year(GetDate()),10,31)
-- 			Else
-- 				DateFromParts(Year(GetDate()) - 1,10,31)
-- 			End
-- )
-- Declare @rolling_date As Date
-- Select 
-- 	@rolling_date = Eomonth(Max([Report Date]),-11)
-- From 
-- 	hpw_data
-- Where 
-- 	[Worker Reg / Temp Code] = 'R' 
-- And 
-- 	[Worker Status Category Code] = 'A'

SELECT 
	S.[Report Date],
	S.[Hybrid L1],
	S.[Hybrid L2],
	S.[Work Address - City],
	S.[Technical Job Family],
	S.[Veteran Status],
	S.[PWD Status],
	S.[Pay Group Country Desc],
	S.[Ethnicity Group],
	S.[Gender Code],
	S.[Is Professional],
	S.[Is New Hire],
	S.[Management Level Category],
	S.[Management],
	SUM(S.[Headcount]) AS [HC],
	SUM(S.[Voluntary Attrition]) AS [Voluntary Attrits]
FROM (
	-- HC SELECT
	SELECT 
		WD.[Report Date],
		'SNI' AS [Hybrid L1],
		-- CASE 
		-- 	WHEN WD.[Hybrid L1 Code] = 'HPCS' THEN 'HCCO'
		-- 	WHEN WD.[Hybrid L2 Code] = 'PRO' THEN 'GIP'
		-- 	WHEN WD.[Hybrid L2 Code] = 'GRE' THEN 'CREW'			
		-- 	WHEN WD.[Hybrid L3 Code] IN ('3_DP','3DCO','3DMT','3DSW','3DSY','3DVT') THEN 'SNI'
		-- 	WHEN WD.[Hybrid L1 Code] = 'SBM' THEN 'SNI'
		-- 	WHEN WD.[Report Date] > @fy_start AND WD.[Hybrid L1 Code] = 'HPIB' THEN 'HPIP'
		-- 	ELSE WD.[Hybrid L1 Code]
		-- END AS [Hybrid L1],
		CASE
			WHEN WD.[Worker ID] IN (
				'00447640',
				'00304474',
				'00305331',
				'00591831',
				'00461219',
				'00447636',
				'00295980',
				'00339302',
				'90020550',
				'90020699',
				'81053631',
				'90016851',
				'00402082',
				'00255139',
				'21753134',
				'60021220',
				'00560128',
				'90007582',
				'90032219',
				'90030397',
				'00490505',
				'90032967',
				'90030179',
				'21816482',
				'21666737',
				'00363778',
				'90025924',
				'90029563',
				'00464089',
				'90016242',
				'00652450',
				'90030831',
				'90031116',
				'90034805',
				'00489563',
				'60042947',
				'90032236',
				'00462771',
				'20253977',
				'21622925',
				'90029454',
				'90036073',
				'90036277',
				'60000568',
				'90008403',
				'90013016',
				'21824690',
				'90033349',
				'60013536',
				'90028318',
				'20074124',
				'90036332',
				'90036755',
				'90026333',
				'60008261',
				'90024789',
				'90003330',
				'20289991',
				'90023728',
				'20435771',
				'21725728',
				'60062144',
				'20303859',
				'20435034',
				'90015789',
				'90017047',
				'90030681',
				'90031175',
				'90034195',
				'90032508',
				'90031528',
				'00451477',
				'90025684',
				'90024024',
				'90029488',
				'90031159',
				'90032930',
				'21944614',
				'21690708',
				'00516151',
				'00398243',
				'21969278',
				'60003670',
				'60036308',
				'60059912',
				'60060484') THEN 'SHZ'
			WHEN WD.[Worker ID] IN (
				'00402631',
				'00652499',
				'00402132',
				'00527057',
				'60059903',
				'90020189',
				'90005511',
				'20388560',
				'00402529',
				'00402731',
				'20306964',
				'21786332',
				'00402222',
				'00115712',
				'90026708',
				'90019739',
				'90027831',
				'00403927',
				'90011608',
				'90027006',
				'90005676',
				'00649392',
				'60028290',
				'21667216',
				'00545372',
				'21811750',
				'21504824',
				'00434610',
				'90024034',
				'90011789',
				'90022656',
				'00496478',
				'90009075',
				'90008052',
				'90020377',
				'90025469',
				'00304658',
				'90027246',
				'90032804',
				'90001524',
				'90008507',
				'90010589',
				'90016205',
				'90006676',
				'00525675',
				'07884170',
				'90002485',
				'90002628',
				'90003383',
				'00650216',
				'21531754',
				'00450179',
				'90036841',
				'90027169',
				'90029308',
				'90009760',
				'90009845',
				'07822716',
				'21500811',
				'07820444',
				'90003137',
				'90015303',
				'90015391',
				'90016440',
				'90013912',
				'90005084',
				'90013869',
				'90036257',
				'90035571',
				'00443374',
				'90003227',
				'20411511',
				'90013449',
				'90026924',
				'00126304',
				'90010468',
				'00651838',
				'00148572',
				'00527333',
				'20300670',
				'90024954',
				'90010761',
				'90029501',
				'90008251',
				'90035186',
				'90028709',
				'90005426',
				'00572433',
				'90021070',
				'90026697',
				'90014054',
				'00586687',
				'90014407',
				'90030916',
				'90016157',
				'90030075',
				'90002405',
				'90018973',
				'90011818',
				'90011823',
				'90011702',
				'00496358',
				'90003698',
				'90026744',
				'90002054',
				'90012777',
				'00402105',
				'90028471',
				'90026491',
				'90014478',
				'21665419',
				'90013252',
				'90020183',
				'21756138',
				'21776802',
				'90006211',
				'90011746',
				'00402002',
				'90014981',
				'90019417',
				'60041410',
				'00402175',
				'90022633',
				'90005060',
				'90009101',
				'90013121',
				'21869482',
				'90002088',
				'90003286',
				'00496463',
				'90007899',
				'00527160',
				'00402141',
				'00648088',
				'00402098',
				'00402264',
				'90001125',
				'21739065',
				'90026091',
				'90001521',
				'90005869',
				'00402163',
				'21705989',
				'20075552',
				'90002268',
				'90025829',
				'20298985',
				'60058733',
				'60059574',
				'00402193',
				'20011242',
				'00402610',
				'20384194',
				'90020973',
				'60061913',
				'60025740',
				'90006291',
				'20349855',
				'90027157',
				'00402682',
				'60020068',
				'90008400',
				'20290922',
				'90027777',
				'90023053',
				'90016055',
				'90016057',
				'90019520',
				'90010473',
				'20379936',
				'90015847',
				'90026305',
				'00403277',
				'00403787',
				'00403011',
				'90011744',
				'90026496',
				'90003496',
				'90015325',
				'90004358',
				'90004965',
				'60025150',
				'20396922',
				'90001553',
				'90021692',
				'90017514',
				'20331973',
				'90018884',
				'90015371',
				'71007965',
				'21919823',
				'90035551',
				'90028321',
				'90019762',
				'90024944',
				'90019269',
				'90024256',
				'21646642',
				'90019696',
				'90026602',
				'90023179',
				'90036561',
				'90027153',
				'90007382',
				'00402263',
				'90013662',
				'00148254',
				'00402147',
				'00649797',
				'60039481',
				'21741309',
				'20316790',
				'00255921',
				'90030815',
				'00255261',
				'00256018',
				'90024585',
				'00352334',
				'90027902',
				'70000027',
				'70000029',
				'70000032',
				'90008819',
				'21625287',
				'00143172',
				'20389115',
				'00402070',
				'00402152',
				'90015089',
				'21981674',
				'90026960',
				'90003512',
				'90004426',
				'90009428',
				'00402316',
				'90025238',
				'00309144',
				'20002318',
				'90029565',
				'90029569',
				'21611881',
				'90007281',
				'00464177',
				'90010075',
				'00319277',
				'21998852',
				'90025155',
				'90032452',
				'90027616',
				'90018325',
				'90008603',
				'90016802',
				'90006375',
				'00308765',
				'90015238',
				'90015110',
				'90033216',
				'90030202',
				'60035879',
				'90034056',
				'90035053',
				'90034910',
				'21675637',
				'20312117',
				'90016556',
				'21990317',
				'60045228',
				'21855350',
				'90032841',
				'60047676',
				'20972640',
				'20435102',
				'00660365',
				'90026019',
				'00587729',
				'00551565',
				'00368361',
				'90029929',
				'90002436',
				'00415234',
				'00447870',
				'00199194',
				'00451464',
				'00350001',
				'00645043',
				'90035679',
				'00350347',
				'00590392',
				'00496189',
				'00402329',
				'21860817',
				'21876478',
				'90026654',
				'90026776',
				'90007938',
				'90012628',
				'60010486',
				'20329965',
				'00402072',
				'20315875',
				'90002016',
				'90007444',
				'90020392',
				'00402687',
				'00402110',
				'20345483',
				'00402154',
				'00402331',
				'60059942',
				'00527379',
				'00402176',
				'90022950',
				'22009159',
				'90016628',
				'90028202',
				'21891923',
				'90028208',
				'90019443',
				'90013158',
				'90022289',
				'21676940',
				'90027242',
				'90022813',
				'90004805',
				'60039116',
				'90013133',
				'90019420',
				'90026754',
				'90022435',
				'90011002',
				'90015947',
				'90021128',
				'21564073',
				'90018200',
				'00402209',
				'00496447',
				'00527341',
				'20294892',
				'00403118',
				'00403546',
				'00527486',
				'00402762',
				'90004836',
				'90020687',
				'90003173',
				'00402243',
				'00652937',
				'00402133',
				'60050749',
				'00488475',
				'00402304',
				'00402112',
				'00527378',
				'00527369',
				'00402087',
				'00527492',
				'90027500',
				'21870175',
				'90010844',
				'60051643',
				'90009863',
				'90002052',
				'90012636',
				'90008004',
				'90013135',
				'21782173',
				'90014481',
				'90018620',
				'60050827',
				'00402203',
				'90018310',
				'90009279',
				'00402374',
				'00402292',
				'00402580',
				'00402254',
				'90021755',
				'90005757',
				'90012097',
				'60039461',
				'21975806',
				'90020483',
				'90020661',
				'90011679',
				'90027107',
				'90027155',
				'90003388',
				'90009698',
				'90004953',
				'90013286',
				'90010318',
				'90013132',
				'90013157',
				'90007927',
				'21872190',
				'90005527',
				'60027906',
				'90006362',
				'00527476',
				'90003880',
				'60050311',
				'60030540',
				'60059605',
				'60034522',
				'20283141',
				'00402206',
				'90027321',
				'21778526',
				'90025830',
				'90001703',
				'00648555',
				'90007144',
				'90009949',
				'90014947',
				'90025831',
				'90001818',
				'90003988',
				'21597377',
				'90013627',
				'60044403',
				'22019605',
				'90026410',
				'60039467',
				'90013253',
				'60019890',
				'90006576',
				'90004347',
				'90023054',
				'90008472',
				'90019134',
				'90027106',
				'60045749',
				'90007901',
				'00402136',
				'90007012',
				'90008401',
				'90010010',
				'90001647',
				'90012016',
				'00402107',
				'00527337',
				'90019282',
				'90007846',
				'90009330',
				'20277363',
				'21946689',
				'90026508',
				'90021524',
				'90013299',
				'00651218',
				'90035243',
				'21937741',
				'00490958',
				'90014758',
				'00464169',
				'00447957',
				'00305807',
				'00306081',
				'00256179',
				'00303767',
				'00528453',
				'00591815',
				'00304690',
				'90003646',
				'90028692',
				'00305878',
				'90005754',
				'90008003',
				'90010067',
				'90013207',
				'22016988',
				'90014851',
				'90017048',
				'90003016',
				'00496178',
				'90019647',
				'21846282',
				'60006979',
				'00661132',
				'00305800',
				'00528445',
				'21611146',
				'00304426',
				'00254931',
				'00199291',
				'00306148',
				'00307482',
				'90001662',
				'90026106',
				'90010265',
				'00587786',
				'90011733',
				'90009020',
				'90023966',
				'90025937',
				'90003332',
				'60036153',
				'21747774',
				'00528308',
				'00551974',
				'00502197',
				'00306272',
				'00304480',
				'00254836',
				'00502302',
				'00304465',
				'21953731',
				'20299844',
				'00255334',
				'90013686',
				'00255864',
				'00651296',
				'90004114',
				'00309649',
				'90017464',
				'00304450',
				'00587760',
				'90012722',
				'00651641',
				'00255883',
				'90002734',
				'60005768',
				'90027614',
				'21959901',
				'90032672',
				'90036584',
				'00496423',
				'90019302',
				'00801031',
				'00256275',
				'90032234',
				'90034023',
				'90004081',
				'00645824',
				'90000695',
				'00117955',
				'90020348',
				'90026798',
				'90027166',
				'90031926',
				'00255109',
				'00211246',
				'90031980',
				'90001988',
				'20137808',
				'20351713',
				'90031540',
				'90031542',
				'90033588',
				'90034017',
				'00255735',
				'90035263',
				'90034018',
				'20060503',
				'90024123',
				'21738440',
				'90004793',
				'90017971',
				'90026565',
				'21700010',
				'00496293',
				'00527336',
				'90030528',
				'00255846',
				'00255768',
				'20014318',
				'00495943',
				'00464299',
				'90030194',
				'90031133',
				'00229463',
				'21955510',
				'90003515',
				'10024535',
				'00255874',
				'21823784',
				'00402049',
				'90033202',
				'20385648',
				'21565661',
				'60013228',
				'21763385',
				'90026808',
				'90019247',
				'00496422',
				'00652676',
				'21683932',
				'20136913',
				'00550284',
				'20166879',
				'90026773',
				'00255256',
				'90007818',
				'20303859',
				'20435771',
				'21725728',
				'60062144',
				'90015789',
				'90017047',
				'90024024',
				'90025684',
				'90029488',
				'90030681',
				'90031159',
				'90032930') THEN 'P3D'
		ELSE
		COALESCE(F2.[Business Lvl 2 (Unit) Code],WD.[Business Lvl 2 (Unit) Code]) END AS [Hybrid L2],

		CASE
			WHEN WD.[Work Address - City] = 'Boise' THEN WD.[Work Address - City]
			WHEN WD.[Work Address - City] = 'Vancouver' THEN WD.[Work Address - City]
			ELSE 'Other'
		END AS [Work Address - City],

		CASE
			WHEN TT.[Job Family Code] IS NULL THEN 'No'
			ELSE 'Yes'
		END AS [Technical Job Family],

		CASE
			WHEN WD.[Business Lvl 4 (MRU) Code] = 'G034' THEN WD.[Business Lvl 4 (MRU) Code]
			ELSE 'Other'
		END AS [Business Lvl 4 (MRU) Code],
		CASE
			WHEN VET.[Employee ID] IS NULL THEN 'U'
			ELSE VET.[Veteran Status]
		END AS [Veteran Status],
		CASE
			WHEN WD.[Pay Group Country Desc] IN (
			'Austria',
			'Belgium',
			'Bulgaria',
			'Croatia',
			'Czechia',
			'Denmark',
			'FinlAnd',
			'Greece',
			'Hungary',
			'IrelAnd',
			'Israel',
			'Kazakhstan',
			'Luxembourg',
			'Morocco',
			'NetherlAnds',
			'Nigeria',
			'Norway',
			'PolAnd',
			'Portugal',
			'Russian FederatiOn',
			'Saudi Arabia',
			'Serbia',
			'Slovakia',
			'South Africa',
			'Sweden',
			'Tunisia',
			'Turkey',
			'United Arab Emirates')
			THEN 'U'
			WHEN PWD.[Employee ID] IS NULL THEN 'N'
			ELSE PWD.[Is PWD?]
		END AS [PWD Status],

		CASE
			WHEN WD.[Work Address - Country Code] = 'USA' THEN WD.[Work Address - Country]
			ELSE 'Other'
		END AS [Pay Group Country Desc],

		CASE
			WHEN WD.[Work Address - Country Code] = 'USA' THEN WD.[Ethnicity Group]
			ELSE 'Other'
		END AS [Ethnicity Group],
		COALESCE(WD.[Gender Code],'U') AS [Gender Code],

		CASE
			WHEN WD.[Management Level Category] <> 'NONE' THEN 'Yes'
			ELSE 'No'
		END AS [Is Professional],

		CASE
			WHEN WD.[Original Hire Date] > @fy_start OR WD.[Hire Date] > @fy_start THEN 'Yes'
			ELSE 'No'
		END AS [Is New Hire],
		CASE
            WHEN WD.[Management Level] IN ('EXE', 'DIR') THEN 'Yes'
            ELSE 'No'
        END AS [Management],
		WD.[Management Level Category],

		CASE
			WHEN WD.[Worker Reg / Temp Code] = 'R' AND WD.[Worker Status Category Code] = 'A' THEN 1
			ELSE 0
		END [Headcount],
		
		CASE
			WHEN WD.[Worker Status Category Code] = 'T' AND WD.[Attrition Type] = 'Voluntary' THEN 1
			ELSE 0
		END [Voluntary Attrition],
		'HC' AS [Type]
	
	FROM hpw_data AS WD

	LEFT JOIN job_function AS JF ON JF.[Job Family Group] = WD.[Job Family Group]
	LEFT JOIN labor_pyramid AS LP ON LP.[Management Level] = WD.[Management Level]
	LEFT JOIN fedl1 AS F1 ON F1.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
	LEFT JOIN fedl2 AS F2 ON F2.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
	LEFT JOIN fedl3 AS F3 ON F3.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
	LEFT JOIN technical_job AS TT ON TT.[Job Family Code] = WD.[Job Family Code]
	LEFT JOIN hpw_veteran AS VET ON VET.[Report Date] = WD.[Report Date] AND VET.[Employee ID] = WD.[Worker ID] AND VET.[Veteran Status] = 'Y'
	LEFT JOIN hpw_w_disability AS PWD ON PWD.[Employee ID] = WD.[Worker ID] AND PWD.[Report Date] = (Select Max([Report Date]) From hpw_w_disability)

	WHERE 
		WD.[Report Date] > '2020-10-31'
		AND WD.[Report Date] <= '2021-10-31'
		AND WD.[Worker Reg / Temp Code] = 'R'
		AND WD.[Worker Status Category Code] = 'A'
	
	UNION ALL 
	
	-- Attrition Select
	SELECT 
		Eomonth(Dateadd(d, 1, wd.[Termination Date]), 0) AS [Report Date],		
		'SNI' AS [Hybrid L1],
		-- CASE 
		-- 	WHEN WD.[Hybrid L1 Code] = 'HPCS' THEN 'HCCO'
		-- 	WHEN WD.[Hybrid L2 Code] = 'PRO' THEN 'GIP'
		-- 	WHEN WD.[Hybrid L2 Code] = 'GRE' THEN 'CREW'			
		-- 	WHEN WD.[Hybrid L3 Code] IN ('3_DP','3DCO','3DMT','3DSW','3DSY','3DVT') THEN 'SNI'
		-- 	WHEN WD.[Hybrid L1 Code] = 'SBM' THEN 'SNI'
		-- 	WHEN WD.[Report Date] > @fy_start AND WD.[Hybrid L1 Code] = 'HPIB' THEN 'HPIP'
		-- 	ELSE WD.[Hybrid L1 Code]
		-- END AS [Hybrid L1],
		COALESCE(F2.[Business Lvl 2 (Unit) Code],WD.[Business Lvl 2 (Unit) Code]) AS [Hybrid L2],
	
		CASE
			WHEN WD.[Work Address - City] = 'Boise' THEN WD.[Work Address - City]
			WHEN WD.[Work Address - City] = 'Vancouver' THEN WD.[Work Address - City]
			ELSE 'Other'
		END AS [Work Address - City],
	
		CASE
			WHEN TT.[Job Family Code] IS NULL THEN 'No'
			ELSE 'Yes'
		END AS [Technical Job Family],
	
		CASE
			WHEN WD.[Business Lvl 4 (MRU) Code] = N'G034'THEN WD.[Business Lvl 4 (MRU) Code]
			ELSE 'Other'
		END AS [Business Lvl 4 (MRU) Code],
	
		CASE
			WHEN VET.[Employee ID] IS NULL THEN 'U'
			ELSE VET.[Veteran Status]
		END AS [Veteran Status],
	
		CASE
			WHEN WD.[Pay Group Country Desc] IN (
			'Austria',
			'Belgium',
			'Bulgaria',
			'Croatia',
			'Czechia',
			'Denmark',
			'FinlAnd',
			'Greece',
			'Hungary',
			'IrelAnd',
			'Israel',
			'Kazakhstan',
			'Luxembourg',
			'Morocco',
			'NetherlAnds',
			'Nigeria',
			'Norway',
			'PolAnd',
			'Portugal',
			'Russian FederatiOn',
			'Saudi Arabia',
			'Serbia',
			'Slovakia',
			'South Africa',
			'Sweden',
			'Tunisia',
			'Turkey',
			'United Arab Emirates') THEN 'U'
			WHEN PWD.[Employee ID] IS NULL THEN 'N'
			ELSE PWD.[Is PWD?]
		END AS [PWD Status],
	
		CASE
			WHEN WD.[Work Address - Country Code] = 'USA' THEN WD.[Work Address - Country]
			ELSE 'Other'
		END AS [Pay Group Country Desc],
	
		CASE
			WHEN WD.[Work Address - Country Code] = 'USA' THEN WD.[Ethnicity Group]
			ELSE 'Other'
		END AS [Ethnicity Group],
		COALESCE(WD.[Gender Code],'U') AS [Gender Code],
	
		CASE
			WHEN WD.[Management Level Category] <> 'NONE' THEN 'Yes'
			ELSE 'No'
		END AS [Is Professional],
	
		CASE
			WHEN WD.[Original Hire Date] > @fy_start OR WD.[Hire Date] > @fy_start THEN 'Yes'
			ELSE 'No'
		END AS [Is New Hire],
		CASE
            WHEN WD.[Management Level] IN ('EXE', 'DIR') THEN 'Yes'
            ELSE 'No'
        END AS [Management],
		WD.[Management Level Category],
	
		CASE
			WHEN WD.[Worker Reg / Temp Code] = 'R' AND WD.[Worker Status Category Code] = 'A' THEN 1
			ELSE 0
		END [Headcount],
	
		CASE
			WHEN WD.[Worker Status Category Code] = 'T' AND WD.[Attrition Type] = 'Voluntary' THEN 1
			ELSE 0
		END AS [Voluntary Attrition],
		'Attrition' AS [Type]
	FROM hpw_data AS WD
	
		INNER JOIN hpw_attrition AS AD ON AD.[Report Date] = WD.[Report Date] AND AD.[Worker ID] = WD.[Worker ID]
		LEFT JOIN job_function AS JF ON JF.[Job Family Group] = WD.[Job Family Group]
		LEFT JOIN labor_pyramid AS LP ON LP.[Management Level] = WD.[Management Level]
		LEFT JOIN fedl1 AS F1 ON F1.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
		LEFT JOIN fedl2 AS F2 ON F2.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
		LEFT JOIN fedl3 AS F3 ON F3.[Business Lvl 4 (MRU) Code] = WD.[Business Lvl 4 (MRU) Code]
		LEFT JOIN technical_job AS TT ON TT.[Job Family Code] = WD.[Job Family Code]
		LEFT JOIN hpw_veteran AS VET ON VET.[Report Date] = WD.[Report Date]	AND VET.[Employee ID] = WD.[Worker ID]	AND VET.[Veteran Status] = 'Y'
		LEFT JOIN hpw_w_disability AS PWD ON PWD.[Employee ID] = WD.[Worker ID] AND PWD.[Report Date] = (Select Max([Report Date]) From hpw_w_disability)
		
	WHERE 
		Eomonth(Dateadd(d, 1, wd.[Termination Date]), 0) > '2020-10-31'
		AND Eomonth(Dateadd(d, 1, wd.[Termination Date]), 0) <= '2021-10-31'
		
) AS S
WHERE
    S.[Hybrid L2] IN ('SHZ','P3D')
GROUP BY 
	S.[Report Date],	
	S.[Hybrid L1],
	S.[Hybrid L2],
	S.[Work Address - City],
	S.[Technical Job Family],
	S.[Veteran Status],
	S.[PWD Status],
	S.[Pay Group Country Desc],
	S.[Ethnicity Group],
	S.[Gender Code],
	S.[Is Professional],
	S.[Is New Hire],
	S.[Management Level Category],
	S.[Management]
ORDER BY 
	S.[Report Date],	
	S.[Hybrid L1],
	S.[Hybrid L2],
	S.[Work Address - City],
	S.[Technical Job Family],
	S.[Veteran Status],
	S.[PWD Status],
	S.[Pay Group Country Desc]